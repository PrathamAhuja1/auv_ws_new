# Updated Gate Detection Parameters - Orange Flare Rejection Fix
# Place this in: config/gate_params.yaml

gate_detector_node:
  ros__parameters:
    # ===== FIXED HSV RANGES - Red excludes orange =====
    # Red color (H: 0-10 and 170-180) - EXCLUDES orange (H: 11-25)
    red_lower1: [0, 120, 70]      # Low hue red (pure red)
    red_upper1: [10, 255, 255]    # Stops BEFORE orange starts at H=11
    red_lower2: [170, 120, 70]    # High hue red
    red_upper2: [180, 255, 255]
    
    # Green color (H: 35-85) - True green, excludes yellow
    green_lower: [35, 100, 70]
    green_upper: [85, 255, 255]
    
    # Orange flare (H: 11-25) - For explicit detection and rejection
    orange_lower: [11, 100, 100]
    orange_upper: [25, 255, 255]
    
    # ===== STRICTER DETECTION PARAMETERS =====
    # Gate stripes are large and vertical
    min_area_strict: 75           # Minimum area for confident stripe
    min_area_relaxed: 25          # Fallback minimum
    
    # Aspect ratio (h/w) - Gate stripes are VERTICAL
    aspect_threshold: 1.5         # h/w must be > 1.5 (vertical)
    
    # Flare rejection parameters
    flare_max_area: 300           # Flares are small
    flare_aspect_max: 1.5         # Flares are more circular/square
    
    # Gate physical dimensions
    gate_width_meters: 1.5
    
    # Temporal filtering
    detection_history_size: 3
    min_detections_for_confirm: 1
    
    # Debug output
    publish_debug: true

gate_navigator_node:
  ros__parameters:
    target_depth: -1.5
    depth_correction_gain: 1.5
    search_forward_speed: 0.5
    search_rotation_speed: 0.15
    approach_speed: 0.7
    passing_speed: 1.0
    passing_duration: 8.0
    yaw_correction_gain: 1.2
    approach_distance: 3.0
    passing_distance: 1.5
    flare_avoidance_gain: 0.8
    flare_avoidance_duration: 3.0